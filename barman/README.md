# Особенности использования barman в docker

## Дополнительные пакеты
Barman заточен на работу с ssh поэтому внутрь устанавливаю openssh-server 

При первом запуске контейнеров генерю ключи для postgres и barman и добавляю их в autorize_keys

 
## Дополнительные настройки docker

Для возможной работы barman и postgres дополнительно создал отедльный network в докер 
```
docker network create -d bridge pgsteroids
```
Для использования между разными машинами необходимо использовать driver `overlay` 

В текущем примере везде где возможно указывается через параметр --net=pgsteroids

## Особенности запуска 

В конфигах прописано доменные имена для обращания друг к другу pg и backup соответственно. 
При запуске с помощью --link определяются данные dns именна. Единственный момент, в скрипте run дополнительно перед запуском postgres создается контейнер barman для возможности связывания и потом пересоздается уже с правильными настройками. 

Проверку корректности запуска barman можно осуществить с помощью команды 
```
docker exec -u barman barman-vasya-pgsteroids baramn check main
```

